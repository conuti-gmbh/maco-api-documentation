{
  "openapi": "3.1.0",
  "info": {
    "title": "MaloIdent Event API",
    "description": "Schnittstelle zum Start des MaloIdent durch den Lieferanten\n\n<details>\n<summary>Changelog</summary>\n\n**Version 1.0.2** - *09. Dezember 2024* - _Autor: DAS_\n  - Aktualisierung des Event Schema in Bezug auf Zeitscheibenbehandlung\n\n**Version 1.0.1** - *02. Dezember 2024* - _Autor: DAS_\n\n- Aktualisierung des Event Schema - Entferung Netznutzungsvertrag\n\n**Version 1.0.0** - *01. November 2024* - _Autor: DAS_\n\n- Initiale Veröffentlichung der Doku mit dem `START_MALOIDENT`-Schema.\n\n</details>\n",
    "version": "1.0.2",
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "servers": [
    {
      "url": "https://demoapi.macoapp.de",
      "description": "Beispiel URL (Test- und produktive URL weichen ab)"
    }
  ],
  "tags": [
    {
      "name": "LIEFERANT",
      "description": "Trigger Events aus dem Backend in der Rolle Lieferant"
    }
  ],
  "paths": {
    "/core/inbound": {
      "post": {
        "deprecated": false,
        "description": "Versand einer MaloIdent Anfrage via API-Webdienst an den Netzbetreiber",
        "operationId": "START_MALOIDENT",
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "examples": {
                "START_MALOIDENT_NUR_NAME": {
                  "summary": "Beispiel Versand einer MaloIdent Anfrage via API-Webdienst mit Name und Adresse",
                  "value": {
                    "data": {
                      "stammdaten": {
                        "MARKTLOKATION": [
                          {
                            "boTyp": "MARKTLOKATION",
                            "versionStruktur": "1",
                            "marktlokationsId": "12345678901",
                            "energierichtung": "AUSSP",
                            "lokationsadresse": {
                              "postleitzahl": "76229",
                              "ort": "Karlsruhe",
                              "strasse": "Greschbachstrasse",
                              "hausnummer": "3",
                              "adresszusatz": "",
                              "landescode": "DE"
                            }
                          }
                        ]
                      },
                      "transaktionsdaten": {
                        "ausfuehrungsdatum": "2024-11-07T23:00:00Z",
                        "absender": {
                          "rollencodenummer": "9903790000002",
                          "rollencodetype": "BDEW"
                        },
                        "empfaenger": {
                          "rollencodenummer": "9900321000005",
                          "rollencodetype": "BDEW"
                        }
                      }
                    },
                    "zusatzdaten": {
                      "prozessId": "00505688-E4A2-1EDF-A0C2-C81842E2515E",
                      "eventName": "START_MALOIDENT"
                    }
                  }
                },
                "START_MALOIDENT_NAME_ZAHLER": {
                  "summary": "Beispiel Versand einer MaloIdent Anfrage via API-Webdienst mit Name, Adresse und Zaehlernummer",
                  "value": {
                    "data": {
                      "stammdaten": {
                        "MARKTLOKATION": [
                          {
                            "boTyp": "MARKTLOKATION",
                            "versionStruktur": "1",
                            "marktlokationsId": "12345678901",
                            "energierichtung": "AUSSP",
                            "lokationsadresse": {
                              "postleitzahl": "76229",
                              "ort": "Karlsruhe",
                              "strasse": "Greschbachstrasse",
                              "hausnummer": "3",
                              "adresszusatz": "",
                              "landescode": "DE"
                            }
                          }
                        ],
                        "ZAEHLER": [
                          {
                            "boTyp": "ZAEHLER",
                            "versionStruktur": "1",
                            "zaehlernummer": "1760136806"
                          }
                        ]
                      },
                      "transaktionsdaten": {
                        "ausfuehrungsdatum": "2024-11-07T23:00:00Z",
                        "absender": {
                          "rollencodenummer": "9903790000002",
                          "rollencodetype": "BDEW"
                        },
                        "empfaenger": {
                          "rollencodenummer": "9900321000005",
                          "rollencodetype": "BDEW"
                        }
                      }
                    },
                    "zusatzdaten": {
                      "prozessId": "00505688-E4A2-1EDF-A0C2-C81842E2515E",
                      "eventName": "START_MALOIDENT"
                    }
                  }
                },
                "START_MALOIDENT": {
                  "summary": "Beispiel Versand einer MaloIdent Anfrage via API-Webdienst mit allen Feldern gefüllt",
                  "value": {
                    "data": {
                      "stammdaten": {
                        "MARKTLOKATION": [
                          {
                            "boTyp": "MARKTLOKATION",
                            "versionStruktur": "1",
                            "marktlokationsId": "57685676748",
                            "energierichtung": "AUSSP",
                            "lokationsadresse": {
                              "postleitzahl": "12117",
                              "ort": "Berlin",
                              "strasse": "Reinhardtstraße",
                              "hausnummer": "32",
                              "adresszusatz": "Ausbau",
                              "landescode": "DE"
                            },
                            "katasterinformation": {
                              "gemarkung_flur": "Musterstadt",
                              "flurstueck": "123",
                              "flurstueckNummer": "456"
                            },
                            "geokoordinaten": {
                              "breitengrad": "52.5200",
                              "laengengrad": "13.4050",
                              "ostwert": "123456",
                              "nordwert": "654321",
                              "zone": "UTMZone31",
                              "hochwert": "1234567",
                              "rechtswert": "7654321"
                            }
                          }
                        ],
                        "TRANCHE": [
                          {
                            "boTyp": "TRANCHE",
                            "versionStruktur": "1",
                            "tranchenId": "57685676742"
                          }
                        ],
                        "MESSLOKATION": [
                          {
                            "boTyp": "MESSLOKATION",
                            "versionStruktur": "1",
                            "messlokationsId": "DE00014545768S0000000000000003054"
                          }
                        ],
                        "ZAEHLER": [
                          {
                            "boTyp": "ZAEHLER",
                            "versionStruktur": "1",
                            "zaehlernummer": "1SM-8465929523"
                          }
                        ],
                        "ENERGIELIEFERVERTRAG": [
                          {
                            "boTyp": "VERTRAG",
                            "versionStruktur": "1",
                            "vertragsart": "ENERGIELIEFERVERTRAG",
                            "vertragspartner2": [
                              {
                                "boTyp": "GESCHAEFTSPARTNER",
                                "versionStruktur": "1",
                                "anrede": "Prof.Dr.",
                                "name1": "Becker",
                                "name2": "Michael",
                                "gewerbekennzeichnung": false,
                                "geschaeftspartnerrolle": [
                                  "KUNDE"
                                ],
                                "externeReferenzen": [
                                  {
                                    "exRefName": "V567345345",
                                    "exRefWert": "V567345345"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      "transaktionsdaten": {
                        "ausfuehrungsdatum": "2023-08-02T22:00:00Z",
                        "absender": {
                          "rollencodenummer": "4045458000000",
                          "rollencodetype": "BDEW"
                        },
                        "empfaenger": {
                          "rollencodenummer": "4045458000000",
                          "rollencodetype": "BDEW"
                        }
                      }
                    },
                    "zusatzdaten": {
                      "prozessId": "00505688-E4A2-1EDF-A0C2-C81842E2515E",
                      "eventName": "START_MALOIDENT"
                    }
                  }
                }
              },
              "schema": {
                "description": "Schema Versand einer MaloIdent Anfrage via API-Webdienst",
                "type": "object",
                "properties": {
                  "data": {
                    "type": "object",
                    "properties": {
                      "stammdaten": {
                        "type": "object",
                        "properties": {
                          "MARKTLOKATION": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "boTyp": {
                                  "type": "string",
                                  "example": "MARKTLOKATION"
                                },
                                "versionStruktur": {
                                  "type": "string",
                                  "example": "1"
                                },
                                "marktlokationsId": {
                                  "type": "string",
                                  "pattern": "\\d{11}",
                                  "example": "57685676748"
                                },
                                "energierichtung": {
                                  "title": "Energierichtung",
                                  "type": "string",
                                  "enum": [
                                    "AUSSP",
                                    "EINSP"
                                  ]
                                },
                                "lokationsadresse": {
                                  "title": "Adresse",
                                  "type": "object",
                                  "properties": {
                                    "postleitzahl": {
                                      "type": "string"
                                    },
                                    "ort": {
                                      "type": "string"
                                    },
                                    "strasse": {
                                      "type": "string"
                                    },
                                    "hausnummer": {
                                      "type": "string"
                                    },
                                    "postfach": {
                                      "type": "string"
                                    },
                                    "adresszusatz": {
                                      "type": "string"
                                    },
                                    "coErgaenzung": {
                                      "type": "string"
                                    },
                                    "landescode": {
                                      "title": "Landescode",
                                      "type": "string",
                                      "enum": [
                                        "AC",
                                        "AD",
                                        "AE",
                                        "AF",
                                        "AG",
                                        "AI",
                                        "AL",
                                        "AM",
                                        "AN",
                                        "AO",
                                        "AQ",
                                        "AR",
                                        "AS",
                                        "AT",
                                        "AU",
                                        "AW",
                                        "AX",
                                        "AZ",
                                        "BA",
                                        "BB",
                                        "BD",
                                        "BE",
                                        "BF",
                                        "BG",
                                        "BH",
                                        "BI",
                                        "BJ",
                                        "BL",
                                        "BM",
                                        "BN",
                                        "BO",
                                        "BQ",
                                        "BR",
                                        "BS",
                                        "BT",
                                        "BU",
                                        "BV",
                                        "BW",
                                        "BY",
                                        "BZ",
                                        "CA",
                                        "CC",
                                        "CD",
                                        "CF",
                                        "CG",
                                        "CH",
                                        "CI",
                                        "CK",
                                        "CL",
                                        "CM",
                                        "CN",
                                        "CO",
                                        "CP",
                                        "CR",
                                        "CS",
                                        "CU",
                                        "CV",
                                        "CW",
                                        "CX",
                                        "CY",
                                        "CZ",
                                        "DE",
                                        "DG",
                                        "DJ",
                                        "DK",
                                        "DM",
                                        "DO",
                                        "DZ",
                                        "EA",
                                        "EC",
                                        "EE",
                                        "EG",
                                        "EH",
                                        "ER",
                                        "ES",
                                        "ET",
                                        "EU",
                                        "FI",
                                        "FJ",
                                        "FK",
                                        "FM",
                                        "FO",
                                        "FR",
                                        "FX",
                                        "GA",
                                        "GB",
                                        "GD",
                                        "GE",
                                        "GF",
                                        "GG",
                                        "GH",
                                        "GI",
                                        "GL",
                                        "GM",
                                        "GN",
                                        "GP",
                                        "GQ",
                                        "GR",
                                        "GS",
                                        "GT",
                                        "GU",
                                        "GW",
                                        "GY",
                                        "HK",
                                        "HM",
                                        "HN",
                                        "HR",
                                        "HT",
                                        "HU",
                                        "IC",
                                        "ID",
                                        "IE",
                                        "IL",
                                        "IM",
                                        "IN",
                                        "IO",
                                        "IQ",
                                        "IR",
                                        "IS",
                                        "IT",
                                        "JE",
                                        "JM",
                                        "JO",
                                        "JP",
                                        "KE",
                                        "KG",
                                        "KH",
                                        "KI",
                                        "KM",
                                        "KN",
                                        "KP",
                                        "KR",
                                        "KW",
                                        "KY",
                                        "KZ",
                                        "LA",
                                        "LB",
                                        "LC",
                                        "LI",
                                        "LK",
                                        "LR",
                                        "LS",
                                        "LT",
                                        "LU",
                                        "LV",
                                        "LY",
                                        "MA",
                                        "MC",
                                        "MD",
                                        "ME",
                                        "MF",
                                        "MG",
                                        "MH",
                                        "MK",
                                        "ML",
                                        "MM",
                                        "MN",
                                        "MO",
                                        "MP",
                                        "MQ",
                                        "MR",
                                        "MS",
                                        "MT",
                                        "MU",
                                        "MV",
                                        "MW",
                                        "MX",
                                        "MY",
                                        "MZ",
                                        "NA",
                                        "NC",
                                        "NE",
                                        "NF",
                                        "NG",
                                        "NI",
                                        "NL",
                                        "NO",
                                        "NP",
                                        "NR",
                                        "NT",
                                        "NU",
                                        "NZ",
                                        "OM",
                                        "PA",
                                        "PE",
                                        "PF",
                                        "PG",
                                        "PH",
                                        "PK",
                                        "PL",
                                        "PM",
                                        "PN",
                                        "PR",
                                        "PS",
                                        "PT",
                                        "PW",
                                        "PY",
                                        "QA",
                                        "RE",
                                        "RO",
                                        "RS",
                                        "RU",
                                        "RW",
                                        "SA",
                                        "SB",
                                        "SC",
                                        "SD",
                                        "SE",
                                        "SF",
                                        "SG",
                                        "SH",
                                        "SI",
                                        "SJ",
                                        "SK",
                                        "SL",
                                        "SM",
                                        "SN",
                                        "SO",
                                        "SR",
                                        "SS",
                                        "ST",
                                        "SU",
                                        "SV",
                                        "SX",
                                        "SY",
                                        "SZ",
                                        "TA",
                                        "TC",
                                        "TD",
                                        "TF",
                                        "TG",
                                        "TJ",
                                        "TK",
                                        "TL",
                                        "TM",
                                        "TN",
                                        "TO",
                                        "TP",
                                        "TR",
                                        "TT",
                                        "TV",
                                        "TW",
                                        "TZ",
                                        "UA",
                                        "UG",
                                        "UK",
                                        "UM",
                                        "US",
                                        "UY",
                                        "UZ",
                                        "VA",
                                        "VC",
                                        "VE",
                                        "VG",
                                        "VI",
                                        "VN",
                                        "VU",
                                        "WF",
                                        "WS",
                                        "XK",
                                        "YE",
                                        "YT",
                                        "YU",
                                        "ZA",
                                        "ZM",
                                        "ZR",
                                        "ZW"
                                      ]
                                    },
                                    "ortsteil": {
                                      "type": "string"
                                    },
                                    "zusatzInformation": {
                                      "title": "AdresszusatzInformation",
                                      "type": "object",
                                      "properties": {
                                        "zusatz1": {
                                          "type": "string"
                                        },
                                        "zusatz2": {
                                          "type": "string"
                                        },
                                        "zusatz3": {
                                          "type": "string"
                                        },
                                        "zusatz4": {
                                          "type": "string"
                                        },
                                        "zusatz5": {
                                          "type": "string"
                                        }
                                      }
                                    }
                                  }
                                },
                                "katasterinformation": {
                                  "title": "Katasteradresse",
                                  "type": "object",
                                  "properties": {
                                    "gemarkung_flur": {
                                      "type": "string"
                                    },
                                    "flurstueck": {
                                      "type": "string"
                                    },
                                    "flurstueckNummer": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "geokoordinaten": {
                                  "title": "Geokoordinaten",
                                  "type": "object",
                                  "properties": {
                                    "breitengrad": {
                                      "type": "string"
                                    },
                                    "laengengrad": {
                                      "type": "string"
                                    },
                                    "ostwert": {
                                      "type": "string"
                                    },
                                    "nordwert": {
                                      "type": "string"
                                    },
                                    "zone": {
                                      "title": "Zone",
                                      "type": "string",
                                      "enum": [
                                        "UTMZone31",
                                        "UTMZone32",
                                        "UTMZone33"
                                      ]
                                    },
                                    "hochwert": {
                                      "type": "string"
                                    },
                                    "rechtswert": {
                                      "type": "string"
                                    }
                                  }
                                }
                              },
                              "required": [
                                "boTyp",
                                "versionStruktur",
                                "energierichtung"
                              ]
                            }
                          },
                          "TRANCHE": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "boTyp": {
                                  "type": "string",
                                  "example": "TRANCHE"
                                },
                                "versionStruktur": {
                                  "type": "string",
                                  "example": "1"
                                },
                                "tranchenId": {
                                  "type": "string",
                                  "pattern": "\\d{11}",
                                  "example": "57685676742"
                                }
                              },
                              "required": [
                                "boTyp",
                                "versionStruktur"
                              ]
                            }
                          },
                          "MESSLOKATION": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "boTyp": {
                                  "type": "string",
                                  "example": "MESSLOKATION"
                                },
                                "versionStruktur": {
                                  "type": "string",
                                  "example": "1"
                                },
                                "messlokationsId": {
                                  "type": "string",
                                  "pattern": "DE\\d{11}[A-Z,\\d]{20}",
                                  "example": "DE00014545768S0000000000000003054"
                                }
                              },
                              "required": [
                                "boTyp",
                                "versionStruktur"
                              ]
                            }
                          },
                          "ZAEHLER": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "boTyp": {
                                  "type": "string",
                                  "example": "ZAEHLER"
                                },
                                "versionStruktur": {
                                  "type": "string",
                                  "example": "1"
                                },
                                "zaehlernummer": {
                                  "type": "string",
                                  "example": "1SM-8465929523"
                                }
                              },
                              "required": [
                                "boTyp",
                                "versionStruktur"
                              ]
                            }
                          },
                          "ENERGIELIEFERVERTRAG": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "boTyp": {
                                  "type": "string",
                                  "example": "VERTRAG"
                                },
                                "versionStruktur": {
                                  "type": "string",
                                  "example": "1"
                                },
                                "vertragsart": {
                                  "type": "string",
                                  "example": "ENERGIELIEFERVERTRAG"
                                },
                                "vertragspartner2": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "boTyp": {
                                        "type": "string",
                                        "example": "GESCHAEFTSPARTNER"
                                      },
                                      "versionStruktur": {
                                        "type": "string",
                                        "example": "1"
                                      },
                                      "anrede": {
                                        "type": "string",
                                        "example": "Prof.Dr."
                                      },
                                      "name1": {
                                        "type": "string",
                                        "example": "Becker"
                                      },
                                      "name2": {
                                        "type": "string",
                                        "example": "Michael"
                                      },
                                      "gewerbekennzeichnung": {
                                        "type": "boolean",
                                        "example": false
                                      },
                                      "geschaeftspartnerrolle": {
                                        "type": "array",
                                        "items": {
                                          "type": "string",
                                          "example": "KUNDE"
                                        }
                                      },
                                      "externeReferenzen": {
                                        "type": "array",
                                        "items": {
                                          "type": "object",
                                          "properties": {
                                            "exRefName": {
                                              "type": "string",
                                              "example": "Kundennummer beim Altlieferanten"
                                            },
                                            "exRefWert": {
                                              "type": "string",
                                              "example": "V567345345"
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              },
                              "required": [
                                "boTyp",
                                "versionStruktur"
                              ]
                            }
                          }
                        },
                        "required": [
                          "MARKTLOKATION"
                        ]
                      },
                      "transaktionsdaten": {
                        "type": "object",
                        "properties": {
                          "vorgangsnummer": {
                            "type": "string",
                            "example": "f81d4fae-7dec-11d0-a765-00a0c91e6bf6"
                          },
                          "nachrichtendatum": {
                            "type": "string",
                            "pattern": "20(\\d{2}(\\-(0[13578]|1[02])\\-(0[1-9]|[12]\\d|3[01])|\\-02\\-(0[1-9]|1\\d|2[0-8])|\\-(0[469]|11)\\-(0[1-9]|[12]\\d|30))|([02468][048]|[13579][26])\\-02\\-(29))T([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\dZ",
                            "example": "2023-08-01T12:30:00Z"
                          },
                          "ausfuehrungsdatum": {
                            "type": "string",
                            "pattern": "20(\\d{2}(\\-(0[13578]|1[02])\\-(0[1-9]|[12]\\d|3[01])|\\-02\\-(0[1-9]|1\\d|2[0-8])|\\-(0[469]|11)\\-(0[1-9]|[12]\\d|30))|([02468][048]|[13579][26])\\-02\\-(29))T([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\dZ",
                            "example": "2023-08-02T22:00:00Z"
                          },
                          "idempodenzschluessel": {
                            "type": "string",
                            "example": "f81d4fae-7dec-11d0-a765-00a0c91e6bf6"
                          },
                          "absender": {
                            "type": "object",
                            "properties": {
                              "rollencodenummer": {
                                "type": "string",
                                "example": "4045458000000"
                              },
                              "rollencodetype": {
                                "title": "Rollencodetyp",
                                "type": "string",
                                "enum": [
                                  "BDEW",
                                  "GS1",
                                  "GLN",
                                  "DVGW"
                                ]
                              }
                            },
                            "required": [
                              "rollencodenummer",
                              "rollencodetype"
                            ]
                          },
                          "empfaenger": {
                            "type": "object",
                            "properties": {
                              "rollencodenummer": {
                                "type": "string",
                                "example": "4045458000000"
                              },
                              "rollencodetype": {
                                "title": "Rollencodetyp",
                                "type": "string",
                                "enum": [
                                  "BDEW",
                                  "GS1",
                                  "GLN",
                                  "DVGW"
                                ]
                              }
                            },
                            "required": [
                              "rollencodenummer",
                              "rollencodetype"
                            ]
                          }
                        },
                        "required": [
                          "ausfuehrungsdatum",
                          "vorgangsnummer"
                        ]
                      },
                      "zusatzdaten": {
                        "type": "object",
                        "properties": {
                          "prozessId": {
                            "type": "string",
                            "example": "00505688-E4A2-1EDF-A0C2-C81842E2515E"
                          },
                          "eventName": {
                            "type": "string",
                            "example": "START_MALOIDENT"
                          }
                        },
                        "required": [
                          "prozessId",
                          "eventName"
                        ]
                      }
                    },
                    "required": [
                      "stammdaten",
                      "transaktionsdaten",
                      "zusatzdaten"
                    ]
                  }
                },
                "required": [
                  "data"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "description": "Erfolgsmeldung auf Prozessdaten API Aufruf | Success message on process data API call",
                  "properties": {
                    "businessKey": {
                      "description": "Einzigartige Kennung des Geschäftsprozesses | Unique identifier of the business process",
                      "format": "uuid",
                      "type": "string"
                    },
                    "message": {
                      "description": "Nachricht mit Details zum ausgelösten Event | Message with details about the triggered event",
                      "example": "received event XXXXXXXXXXXX with id at 2024-08-08T12:58:22Z and started process with businessKey 4c7170ed-3518-41ee-8582-39ab65b00107",
                      "type": "string"
                    }
                  },
                  "required": [
                    "businessKey",
                    "message"
                  ]
                }
              }
            },
            "description": "Erfolg | Success"
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "description": "Fehlermeldung auf Prozessdaten API Aufruf | Error message on process data API call",
                  "properties": {
                    "errorCode": {
                      "type": "string",
                      "description": "Error identifier",
                      "example": "400"
                    },
                    "message": {
                      "type": "string",
                      "description": "Technische Meldung | Technische Meldung",
                      "example": "Validation Failed"
                    }
                  }
                }
              }
            },
            "description": "Fehler | Fail"
          }
        },
        "security": [],
        "summary": "START_MALOIDENT",
        "tags": [
          "LIEFERANT"
        ]
      }
    }
  }
}
